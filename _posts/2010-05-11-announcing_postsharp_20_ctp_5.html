---
layout: post 
comments: true
title: "Announcing PostSharp 2.0 CTP 5"
date: 2010-05-11 20:26:12 +02:00
categories: []
permalink: /post/announcing-postsharp-20-ctp-5.html
author: "Gael Fraiteur"
---
<p>I am pleased to announce the release of PostSharp 2.0 CTP 5 (build 1199). This is the final CTP, and could have been a release candidate if the documentation were finished. This release is feature-complete and has reached a good level of reliability.</p>  <p>This CTP was silently released last week and updated since two major bugs were quickly discovered. Those who already downloaded a previous revision of this CTP should upgrade now.</p>  <p>What’s New in this CTP?</p>  <h3></h3>  <h2>Support for .NET 4.0 and Visual Studio 2010 RTM</h2>  <p>PostSharp 2.0 now supports the final version of .NET 4.0 and Visual Studio 2010.</p>  <h2>Support for Windows Phone 7, Silverlight, and Compact Framework</h2>  <p>PostSharp 2.0 now supports the following platforms:</p>  <ul>   <li>Microsoft .NET Framework 2.0, 3.0, 3.5, 4.0 </li>    <li>Microsoft .NET Compact Framework 2.0, 3.5 </li>    <li>Microsoft Silverlight 3.0, 4.0 </li>    <li>Microsoft Windows Phone 7 (both Silverlight and XNA), </li>    <li>Novell Mono 2.6. </li> </ul>  <p align="center"><strong><font size="3">Well read: PostSharp now supports Windows Phone 7!</font></strong></p>  <h2>Support for serialization</h2>  <p>Aspects are now correctly initialized when an object is deserialized by the old good BinaryFormatter or by WCF formatters.</p>  <h2>Access from user code to binding classes</h2>  <p>This release has a somewhat cleaner code generation, and aspects now have direct access to binding classes created by PostSharp. Binding classes allow you to invoke the next node in the chain of invocation even outside the lifetime of an advice. (This is quite hard core; I’ll document it later.)</p>  <h2>Merge from PostSharp 1.5 SP1</h2>  <p>This CTP contains all the bug fixes (including regression tests) from PostSharp 1.5 SP1.</p>  <h2>46 bug fixes</h2>  <ul>   <li>COMException from EnvDTE.Project.get_ConfigurationManager() </li>    <li>ArgumentException when getting EnvDTE.ActiveConfiguration from ProjectWatcher.UpdateSymbolPath </li>    <li>NullReferenceException in QuickInfoTracker.OnMouseMove </li>    <li>InvalidCastException in CSharpLanguageAdapter.VisitPropertyAccessor </li>    <li>Disable logging in release build. </li>    <li>Should raise a warning when an aspects has a serialized field of type FieldInfo </li>    <li>When an OnMethodInvocation aspect is applied on a non-const method of a struct, modifications are lost </li>    <li>Make it possible to add aspects to unmanaged (native) methods </li>    <li>Exception: The located assembly's manifest definition does not match the assembly reference </li>    <li>Tracing of DotNet20Platform.GetSymbolReader must be improved </li>    <li>Issues when assemblies to be processed are located in the GAC </li>    <li>&quot;An item with the same key has already been added&quot; thrown from ModuleDeclaration.WriteILDefinition </li>    <li>Support for ASP.NET is broken </li>    <li>Build processed stopped in unattented sessions because of the tray icon </li>    <li>Licensing component throws System.ArgumentException </li>    <li>TypeLevelAspect.RuntimeInitialize is not invoked </li>    <li>Bug in the example NotifyPropertyChanged </li>    <li>Clueless error when trying to apply an interception aspect to an abstract method </li>    <li>MulticastAttributeTask ignores attributes of properties </li>    <li>Advice Analyzer throws a NullReferenceException when the method to be analyzed is abstract </li>    <li>ArgumentOutOfRangeException in LayerRanker.GetRank </li>    <li>NullReferenceException in PostSharp.VisualStudio.VsPackage.BeginInvoke </li>    <li>InvalidOperationException in CodeElementVisitor.GetEnhancedCodeElement </li>    <li>Integration problem with Resharper: Resharper removes PostSharp QuickInfo content </li>    <li>Static constructor of the MSBuild task may crash when hosted in Visual Studio </li>    <li>It should be forbidden to add instance-scoped aspects on a value type </li>    <li>MethodPointcutEngine throws &quot;ArgumentException: You have required a generic definition, but you have passed a generic instance.&quot; </li>    <li>Add property LocationInterceptionArgs.LocationName </li>    <li>Refactor HandlerProviderTransformation and other mechanisms behind advices/pointcuts. </li>    <li>The CLR host should not automatically consider an assembly as CLR-loaded if it's in GAC </li>    <li>Win32Exception in PostSharp.VisualStudio.HWndDispatcher.BeginInvoke </li>    <li>DocumentInfo.GetDocumentInfo should return null when the document is not C# </li>    <li>COMException thrown by EnvDTE.CodeElements.GetEnumerator </li>    <li>Emit a performance warning when PostSharp is executed on an assembly without aspects </li>    <li>Conflict when the same user opens a privileged and non-privileged pipe server </li>    <li>Invalid serialization of type values into custom attributes member: assembly name missing </li>    <li>Multicast inheritance does not work when a type inherits a generic interface defined in a different assembly </li>    <li>Adornment layer not displayed in Visual Studio 2010 RTM </li>    <li>Native host: aspects can't call Assembly.Load with a partial name </li>    <li>Install the license key directly in registry </li>    <li>PostSharp removed from Custom.After.Microsoft.Common.targets during upgrades </li>    <li>VsPackage.GetServiceFromBackgroundThread throws InvalidCastException </li>    <li>Attempt to use two adornment layers when symbol file is updated </li>    <li>Licensing UI should close pipe servers automatically      <br />License or exception dialog box may cause MSBuild to hung </li>    <li>Methods GetUniqueName may cause infinite loop </li> </ul>  <h2>Roadmap</h2>  <p>As I said, this is the last CTP. I am quite confident in the quality of this release, but it still needs to be tested by the community. The reason is that I can’t think about all the possible situations and combinations (I can only test what I expect). I am generally able to fix a bug within 1-2 days if I can reproduce it, so you don’t have to be afraid.</p>  <p>I’ll now spend most of my time in writing the conceptual documentation. I’ll upload frequent updates on <a href="http://doc.sharpcrafters.com/postsharp/2.0">http://doc.sharpcrafters.com/postsharp/2.0</a>. The offline documentation is currently unavailable while work is in progress.</p>  <p>If everything goes right (as I expect), the first release candidate will available early June and the RTW may be released late June, depending on the feedback of the RC.</p>  <p>Happy PostSharping!</p>  <p>-gael</p>
